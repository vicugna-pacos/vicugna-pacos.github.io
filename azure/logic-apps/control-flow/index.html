<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-0L8LJXJEKX"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-0L8LJXJEKX');</script><meta property="og:title" content="フローの流れ方"><meta property="og:description" content="フローの流れ方 フローは矢印の通り上から下に向かって実行される。上下のアクションは「上のアクションの終了ステータスが 成功 だったら、下アクションを実行する」という感じで繋がっている。 アクションの終了ステー"><meta property="og:type" content="article"><meta property="og:url" content="https://vicugna-pacos.github.io/azure/logic-apps/control-flow/"><meta property="article:published_time" content="2022-04-15T13:29:45+09:00"><meta property="article:modified_time" content="2022-04-15T13:29:45+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="フローの流れ方"><meta name=twitter:description content="フローの流れ方 フローは矢印の通り上から下に向かって実行される。上下のアクションは「上のアクションの終了ステータスが 成功 だったら、下アクションを実行する」という感じで繋がっている。 アクションの終了ステー"><meta name=generator content="Hugo 0.74.1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel=stylesheet href=https://vicugna-pacos.github.io/css/normalize.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/main.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/pagination.css><title>フローの流れ方 - アルパカのメモ</title></head><body><header class=header-area><div class=content-container><span class=logo-text><a href=/>アルパカのメモ</a></span></div></header><div class=content-container><nav><ol class=breadcrumbnav><li>Home</li><li>Azure</li><li>Azure Logic Apps (Power Automateも含む)</li></ol></nav></div><main class=main-area><div class="content-container single"><div class=side><aside class=toc><p>目次</p><nav id=TableOfContents><ul><li><a href=#フローの流れ方>フローの流れ方</a></li><li><a href=#スコープ>スコープ</a></li></ul></nav></aside></div><div class=main><article><h1>フローの流れ方</h1><div class=article-info><div><i class=material-icons>calendar_today</i>
<time datetime="2022-04-15 13:29:45 +0900 +0900" itemprop=datePublished>2022-04-15</time></div><div></div></div><h2 id=フローの流れ方>フローの流れ方</h2><p>フローは矢印の通り上から下に向かって実行される。上下のアクションは「上のアクションの終了ステータスが 成功 だったら、下アクションを実行する」という感じで繋がっている。
アクションの終了ステータスは 成功, 失敗, スキップ, タイムアウト などがある。
終了ステータスが 成功 以外の場合は、次アクションの実行をスキップする。
アクションの途中でエラーなった場合、フローの実行が強制終了されるわけではなく、アクションがスキップされつづけている。</p><p>既定のまま作ったフローの場合、途中でエラーがあったときの実行結果は下記の通り。</p><p><img src=2022-04-15-11-23-05.png alt></p><p>エラーの直後のアクションは、前のアクションが 失敗 だったからスキップしている。そしてその次のアクションは、前のアクションが スキップ だったからスキップしている。
アクションを実行するかどうか？の判定が最後のアクションまで行われ続けている。</p><p>それを確認するために、次は一番最後のアクションの実行条件を変更してみる。</p><p>一番最後のアクションで「…」をクリック → 「実行条件の構成」をクリック。</p><p><img src=2022-04-15-13-05-38.png alt></p><p>「がスキップされます」にチェックを入れる → 「完了」をクリック。</p><p><img src=2022-04-15-13-06-51.png alt></p><p>これを実行すると、途中のフローがエラーになっても、最後のフローが実行されているのが分かる。</p><p><img src=2022-04-15-13-07-37.png alt></p><h2 id=スコープ>スコープ</h2><p>「コントロール」の「スコープ」アクションを使うと、複数のアクションをひとまとめにできる。
フローが見やすくなるのに加え、アクション内の終了ステータスを継承するという特徴もある。これを使って、「ひとまとめにしたアクションのうちいずれかが失敗したとき」の処理を作れる。</p><p>例として下記のフローを作った。</p><p><img src=2022-04-15-13-41-19.png alt></p><p>スコープの中の1番目に、失敗になるアクションがある。そして、スコープの次のアクションでは、「失敗」の場合も実行するよう実行条件を追加した。</p><p>このフローの実行結果が下記の通り。</p><p><img src=2022-04-15-13-43-50.png alt></p><p>「エラーになる」アクションで「失敗」となったステータスを、スコープアクションが継承しているのが分かる。</p><p>参考：<a href=https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-control-flow-run-steps-group-scopes target=_blank rel=noopener>Run actions based on group status by using scopes in Azure Logic Apps</a></p></article></div></div></main><footer class=footer-area><div class=content-container><hr><div class=author-container><div class=avatar><img src=/images/avatar.jpg></div><div class=author><p class=author-name>alpaca</p><p>おおむねSIerにいますが、他業種の社内SEだったこともあります。</p><p><a href=https://github.com/vicugna-pacos><img src=/images/GitHub-Mark-32px.png style=width:2rem></a></p></div></div></div></footer></body></html>