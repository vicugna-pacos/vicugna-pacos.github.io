<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-143399608-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-143399608-2');</script><meta property="og:title" content="色々メモ"><meta property="og:description" content="Excel SharePoint, OneDrive に保存した Excel ファイルを操作できるが、テーブルの取得やテーブルへの行の追加など、一覧データの取得、更新くらいしかできない。 テーブル名を指定してデータを取得 「表内に存在する行を一覧表示 (List rows present in a ta"><meta property="og:type" content="article"><meta property="og:url" content="https://vicugna-pacos.github.io/azure/logic-apps/memo/"><meta property="article:published_time" content="2021-05-18T16:05:53+09:00"><meta property="article:modified_time" content="2021-06-15T11:10:59+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="色々メモ"><meta name=twitter:description content="Excel SharePoint, OneDrive に保存した Excel ファイルを操作できるが、テーブルの取得やテーブルへの行の追加など、一覧データの取得、更新くらいしかできない。 テーブル名を指定してデータを取得 「表内に存在する行を一覧表示 (List rows present in a ta"><meta name=generator content="Hugo 0.74.1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel=stylesheet href=https://vicugna-pacos.github.io/css/normalize.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/main.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/pagination.css><title>色々メモ - アルパカのメモ</title></head><body><header class=header-area><div class=content-container><span class=logo-text><a href=/>アルパカのメモ</a></span></div></header><div class=content-container><nav><ol class=breadcrumbnav><li>Home</li><li>Azure</li><li>Azure Logic Apps (Power Automateも含む)</li></ol></nav></div><main class=main-area><div class="content-container single"><div class=side><aside class=toc><p>目次</p><nav id=TableOfContents><ul><li><a href=#excel>Excel</a><ul><li><a href=#テーブル名を指定してデータを取得>テーブル名を指定してデータを取得</a></li></ul></li><li><a href=#日付>日付</a><ul><li><a href=#現在日時の取得>現在日時の取得</a></li><li><a href=#タイムゾーンと書式の変換>タイムゾーンと書式の変換</a></li></ul></li><li><a href=#トラブルシューティング>トラブルシューティング</a><ul><li><a href=#メールの添付ファイルを保存できない>メールの添付ファイルを保存できない</a></li></ul></li><li><a href=#料金>料金</a><ul><li><a href=#サンプル>サンプル</a></li></ul></li></ul></nav></aside></div><div class=main><article><h1>色々メモ</h1><div class=article-info><div><i class=material-icons>calendar_today</i>
<time datetime="2021-05-18 16:05:53 +0900 +0900" itemprop=datePublished>2021-05-18</time>
(最終更新：<time datetime="2021-06-15 11:10:59 +0900 +0900" itemprop=dateModified>2021-06-15</time>)</div><div></div></div><h2 id=excel>Excel</h2><p>SharePoint, OneDrive に保存した Excel ファイルを操作できるが、テーブルの取得やテーブルへの行の追加など、一覧データの取得、更新くらいしかできない。</p><h3 id=テーブル名を指定してデータを取得>テーブル名を指定してデータを取得</h3><p>「表内に存在する行を一覧表示 (List rows present in a table)」を使う。</p><p><img src=2021-06-15-10-42-27.png alt></p><p>テーブル内に日付データがある場合、オプションの「DateTime形式」をどちらにするか検討した方が良い。
既定では「Serial Number」になっていて、日付のシリアル値で取得される。対して「ISO 8601」に変更すると、「2021-04-01T00:00:00.000Z」のような日付形式になる。
Excelの日付にはタイムゾーンがないので、日本時間のつもりで入力していても、末尾にZがついてUTCとして取得される。
Logic App 内で日付を扱いたいときは、replace 関数などで Z を +09:00 に置き換えてから扱うと良い。</p><p>オプションの「フィルタークエリ」には ODATA クエリ形式でフィルターを設定できる。
こちらは日付データに対してはシリアル値を指定しないといけない。
Logic App でシリアル値を求めるのが面倒くさい場合は、全データ取得後、「アレイのフィルター処理」でデータを抽出できる。</p><p><img src=2021-06-15-11-35-00.png alt></p><h2 id=日付>日付</h2><h3 id=現在日時の取得>現在日時の取得</h3><p>「現在の時刻」を使う。</p><p><img src=2021-06-15-11-05-52.png alt></p><p>タイムゾーンがUTCになっているので、日本時間へ変換してから扱った方がいい場合がある。</p><h3 id=タイムゾーンと書式の変換>タイムゾーンと書式の変換</h3><p>「タイムゾーンの変換」を使うと、ついでに書式の変換もできる。</p><p><img src=2021-06-15-11-09-24.png alt></p><h2 id=トラブルシューティング>トラブルシューティング</h2><h3 id=メールの添付ファイルを保存できない>メールの添付ファイルを保存できない</h3><p>現象：<br>メール受信をトリガーとしたフローで、添付ファイルの保存がエラーとなるか、保存できても0KBになってしまう。</p><p>原因：<br>メール受信トリガーで、「添付ファイルを含める」を「はい」にしていない。</p><h2 id=料金>料金</h2><p>Logic App のリソースは、従来通りの Consumption と後からできた Standard の二種類がある。
Consumption はマルチテナント または 総合サービス環境 (integration service environment) で実行され、Standard はシングルテナントで実行される。</p><p>Consumption (マルチテナント)：</p><ul><li>簡単に始められる</li><li>従量課金</li><li>フルマネージド</li><li>1つの Logic App リソースに対して、ワークフローは1つのみ。</li></ul><p>Standard：</p><ul><li>Azure Functions が実行できる場所であれば、ほぼ実行できる。デプロイメントスロットは現在はサポートされていない。</li><li>1つの Logic App リソースに対して、複数のワークフローを作成できる。ワークフローには ステートレス と ステートフル がある。</li><li>価格は、Logic App が実行(起動？)されている間の時間で課金される。</li></ul><p>制限：
<a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-limits-and-config?tabs=azure-portal">https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-limits-and-config?tabs=azure-portal</a></p><h3 id=サンプル>サンプル</h3><p>Consumption で作った、特定のメールが届いたら転送するワークフローを例にする。</p><p><img src=2021-09-01-14-56-42.png alt></p><p>価格表によると、1アクションが ¥0.003136 、Standard コネクタ が ¥0.014560 なので、
このトリガーでは3分に1回メールをチェックする設定になっているので、1ヶ月あたりの料金は</p><pre><code>¥0.014560 × 20回 × 24時間 × 31日 ＝ およそ¥217
</code></pre><p>となる。<br>3分に1回トリガーが動いているということなので、たとえメールが1通も届かなくても料金が発生する。</p></article></div></div></main><footer class=footer-area><div class=content-container><hr><div class=author-container><div class=avatar><img src=/images/avatar.jpg></div><div class=author><p class=author-name>alpaca</p><p>おおむねSIerにいますが、他業種の社内SEだったこともあります。</p><p><a href=https://github.com/vicugna-pacos><img src=/images/GitHub-Mark-32px.png style=width:2rem></a></p></div></div></div></footer></body></html>