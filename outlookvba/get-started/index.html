<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-143399608-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-143399608-2');</script><meta property="og:title" content="はじめの一歩"><meta property="og:description" content="はじめに Outlook VBA の始め方を記載する。 PC にインストール済みの Outlook に付随している Visual Basic for Applications を使ったマクロ開発を目指す。 Office のバージョンは 365 。 開発タブを表示する 既定では Outlook のリボンに「開発」タブが表示されていないので、"><meta property="og:type" content="article"><meta property="og:url" content="https://vicugna-pacos.github.io/outlookvba/get-started/"><meta property="article:published_time" content="2021-08-27T16:41:31+09:00"><meta property="article:modified_time" content="2021-08-27T16:41:31+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="はじめの一歩"><meta name=twitter:description content="はじめに Outlook VBA の始め方を記載する。 PC にインストール済みの Outlook に付随している Visual Basic for Applications を使ったマクロ開発を目指す。 Office のバージョンは 365 。 開発タブを表示する 既定では Outlook のリボンに「開発」タブが表示されていないので、"><meta name=generator content="Hugo 0.74.1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel=stylesheet href=https://vicugna-pacos.github.io/css/normalize.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/main.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/pagination.css><title>はじめの一歩 - アルパカのメモ</title></head><body><header class=header-area><div class=content-container><span class=logo-text><a href=/>アルパカのメモ</a></span></div></header><div class=content-container><nav><ol class=breadcrumbnav><li>Home</li><li>Outlook VBA</li></ol></nav></div><main class=main-area><div class="content-container single"><div class=side><aside class=toc><p>目次</p><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#開発タブを表示する>開発タブを表示する</a></li><li><a href=#マクロの実行を許可する>マクロの実行を許可する</a></li><li><a href=#エディタを開く>エディタを開く</a></li><li><a href=#プロジェクトとは>プロジェクトとは</a></li></ul></nav></aside></div><div class=main><article><h1>はじめの一歩</h1><div class=article-info><div><i class=material-icons>calendar_today</i>
<time datetime="2021-08-27 16:41:31 +0900 +0900" itemprop=datePublished>2021-08-27</time></div><div></div></div><h2 id=はじめに>はじめに</h2><p>Outlook VBA の始め方を記載する。
PC にインストール済みの Outlook に付随している Visual Basic for Applications を使ったマクロ開発を目指す。</p><p>Office のバージョンは 365 。</p><h2 id=開発タブを表示する>開発タブを表示する</h2><p>既定では Outlook のリボンに「開発」タブが表示されていないので、設定を変更する。</p><ol><li>ファイル → オプション → リボンのユーザー設定 をクリック。</li><li>右側のリストにある「開発」にチェックを入れ、OKボタンをクリック。</li><li>リボンに「開発」タブが表示される。</li></ol><h2 id=マクロの実行を許可する>マクロの実行を許可する</h2><p>既定では自作のマクロが実行されないので、設定を変更する。</p><ol><li>「開発」タブ → マクロのセキュリティ をクリック。</li><li>「マクロの設定」欄にある選択肢で、下記のいずれかを選択してOKボタンをクリック。<ul><li>すべてのマクロに対して警告を表示する</li><li>すべてのマクロを有効にする</li></ul></li><li>Outlook を再起動する</li></ol><p>「すべてのマクロに対して警告を表示する」にすると、マクロを実行するたびに警告が表示され、実行するかどうか選ぶ必要がある。それが煩わしいのであれば、リスクを検討したうえで「すべてのマクロを有効にする」を選ぶと良いと思われる。</p><h2 id=エディタを開く>エディタを開く</h2><ol><li>「開発」タブ → Visual Basic をクリック。</li><li>セキュリティの警告が表示されたら、「マクロを有効にする」をクリック。</li><li>Visual Basic for Applications が起動する。</li></ol><h2 id=プロジェクトとは>プロジェクトとは</h2><p>エディタの左側を見ると、オブジェクトやモジュールは「Project1」の中に作られるように見える。</p><p><img src=2021-08-31-13-32-29.png alt></p><p>この「プロジェクト」は、既定で作成され、1ユーザーごとに1つだけ使える。同時に複数プロジェクトを作ったり実行したりはできない。「VbaProject.OTM」はユーザーフォルダに保存されている (Windows 10 の PC で調べてみたところ、<code>%APPDATA%\Microsoft\Outlook</code> に保存されていた) 。</p><p>別のプロジェクトファイルを実行したい場合は、下記の手順が必要。</p><ol><li>Outlook を終了させる。</li><li>現在の VbaProject.OTM を別の名前へ変更する。</li><li>実行したい方のプロジェクトファイルの名前を、VbaProject.OTM へ変更する。</li><li>Outlook を起動する。</li></ol><p>VBA は個人が自分で作って使うことを前提としているため、他の人へ配布するのには向いていない。もしマクロを他の PC に共有したい場合は、フォームやモジュールを1つずつエクスポート＆インポートするとよい。</p><p>複数名へ配布するようなものを開発したい場合は、VBA ではなく Outlook COM Add-in を使うことを検討するとよい。</p><p>参考：<a href=https://docs.microsoft.com/en-us/office/vba/outlook/concepts/getting-started/using-visual-basic-for-applications-in-outlook target=_blank rel=noopener>Using Visual Basic for Applications in Outlook | Microsoft Docs</a></p></article></div></div></main><footer class=footer-area><div class=content-container><hr><div class=author-container><div class=avatar><img src=/images/avatar.jpg></div><div class=author><p class=author-name>alpaca</p><p>おおむねSIerにいますが、他業種の社内SEだったこともあります。</p><p><a href=https://github.com/vicugna-pacos><img src=/images/GitHub-Mark-32px.png style=width:2rem></a></p></div></div></div></footer></body></html>