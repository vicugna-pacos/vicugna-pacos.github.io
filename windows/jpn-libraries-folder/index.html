<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-0L8LJXJEKX"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-0L8LJXJEKX');</script><meta property="og:title" content="英語になってしまったフォルダ名を直す"><meta property="og:description" content="現象 Windows 10 のPCを使っていて、ある時からライブラリのフォルダが英語になってしまった。 私の場合は、ダウンロードフォルダが英語になってしまった。 原因 私の場合、ダウンロードフォルダにあるファイルを、システムフ"><meta property="og:type" content="article"><meta property="og:url" content="https://vicugna-pacos.github.io/windows/jpn-libraries-folder/"><meta property="article:published_time" content="2022-01-21T10:54:11+09:00"><meta property="article:modified_time" content="2022-01-21T10:54:11+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="英語になってしまったフォルダ名を直す"><meta name=twitter:description content="現象 Windows 10 のPCを使っていて、ある時からライブラリのフォルダが英語になってしまった。 私の場合は、ダウンロードフォルダが英語になってしまった。 原因 私の場合、ダウンロードフォルダにあるファイルを、システムフ"><meta name=generator content="Hugo 0.74.1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel=stylesheet href=https://vicugna-pacos.github.io/css/normalize.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/main.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/pagination.css><title>英語になってしまったフォルダ名を直す - アルパカのメモ</title></head><body><header class=header-area><div class=content-container><span class=logo-text><a href=/>アルパカのメモ</a></span></div></header><div class=content-container><nav><ol class=breadcrumbnav><li>Home</li><li>Windows</li></ol></nav></div><main class=main-area><div class="content-container single"><div class=side><aside class=toc><p>目次</p><nav id=TableOfContents><ul><li><a href=#現象>現象</a></li><li><a href=#原因>原因</a></li><li><a href=#解決策>解決策</a></li><li><a href=#再発防止>再発防止</a></li></ul></nav></aside></div><div class=main><article><h1>英語になってしまったフォルダ名を直す</h1><div class=article-info><div><i class=material-icons>calendar_today</i>
<time datetime="2022-01-21 10:54:11 +0900 +0900" itemprop=datePublished>2022-01-21</time></div><div></div></div><h2 id=現象>現象</h2><p>Windows 10 のPCを使っていて、ある時からライブラリのフォルダが英語になってしまった。
私の場合は、ダウンロードフォルダが英語になってしまった。</p><p><img src=2022-01-21-10-55-29.png alt></p><h2 id=原因>原因</h2><p>私の場合、ダウンロードフォルダにあるファイルを、システムファイルを含めて削除してしまったことが原因だった。</p><p>ダウンロードフォルダの名前が日本語が英語になるかは、システムファイル desktop.ini で決まっている。
このファイルはダウンロードフォルダを含めたライブラリフォルダそれぞれの中にある。
普段は表示されておらず、フォルダオプションで「保護されたオペレーティングシステムファイルを表示しない」のチェックを外すと表示される。</p><p><img src=2022-01-21-11-02-47.png alt></p><p>ファイル削除に使ったスクリプトは VBS または VBA で、下記の通り。</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=color:#111>delete_file</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;C:\Users\xxx\Downloads\*.*&#34;</span>
<span style=color:#00a8c8>Set</span> <span style=color:#111>objFS</span> <span style=color:#f92672>=</span> <span style=color:#111>CreateObject</span><span style=color:#111>(</span><span style=color:#d88200>&#34;Scripting.FileSystemObject&#34;</span><span style=color:#111>)</span>
<span style=color:#00a8c8>Call</span> <span style=color:#111>objFS</span><span style=color:#111>.</span><span style=color:#111>DeleteFile</span><span style=color:#111>(</span><span style=color:#111>delete_file</span><span style=color:#111>)</span>
</code></pre></div><p>このスクリプトで desktop.ini まで削除してしまった。ちなみにフォルダオプションではシステムファイルを表示しない設定になっていたが、スクリプトには関係なかった。</p><h2 id=解決策>解決策</h2><p>下記コマンドを、コマンドプロンプトで実行する。</p><pre><code>regsvr32 shell32.dll /i:U
</code></pre><p>コマンド実行後、PCを再起動すれば直っている。</p><p>regsvr32 は、dllをレジストリに登録/削除するコマンド。shell32.dll は Windows に必要な色々が入っている。</p><p>もしくは、PC に作った他のユーザーのダウンロードフォルダにある desktop.ini をコピーして、問題のユーザーのダウンロードフォルダに貼り付ける。
こちらも、貼り付けた後 PC を再起動すると直る。</p><h2 id=再発防止>再発防止</h2><p>ライブラリフォルダ直下を、スクリプトで使うようなフォルダにしない。<br>または<br>フォルダ内のファイルを削除するときは、システムファイルを削除しないようにする。</p><p>FileSystemObject を使う場合は、対象フォルダの Files プロパティを参照し、File オブジェクトの <a href=https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/attributes-property target=_blank rel=noopener>Attributes プロパティ</a> をチェックしてから削除する。</p></article></div></div></main><footer class=footer-area><div class=content-container><hr><div class=author-container><div class=avatar><img src=/images/avatar.jpg></div><div class=author><p class=author-name>alpaca</p><p>おおむねSIerにいますが、他業種の社内SEだったこともあります。</p><p><a href=https://github.com/vicugna-pacos><img src=/images/GitHub-Mark-32px.png style=width:2rem></a></p></div></div></div></footer></body></html>