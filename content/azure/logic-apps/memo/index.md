---
title: "色々メモ"
date: 2021-05-18T16:05:53+09:00
lastMod: 2021-06-15T11:10:59+09:00
---

## Excel
SharePoint, OneDrive に保存した Excel ファイルを操作できるが、テーブルの取得やテーブルへの行の追加など、一覧データの取得、更新くらいしかできない。

### テーブル名を指定してデータを取得
「表内に存在する行を一覧表示 (List rows present in a table)」を使う。

![](2021-06-15-10-42-27.png)

テーブル内に日付データがある場合、オプションの「DateTime形式」をどちらにするか検討した方が良い。
既定では「Serial Number」になっていて、日付のシリアル値で取得される。対して「ISO 8601」に変更すると、「2021-04-01T00:00:00.000Z」のような日付形式になる。
Excelの日付にはタイムゾーンがないので、日本時間のつもりで入力していても、末尾にZがついてUTCとして取得される。
Logic App 内で日付を扱いたいときは、replace 関数などで Z を +09:00 に置き換えてから扱うと良い。

オプションの「フィルタークエリ」には ODATA クエリ形式でフィルターを設定できる。
こちらは日付データに対してはシリアル値を指定しないといけない。
Logic App でシリアル値を求めるのが面倒くさい場合は、全データ取得後、「アレイのフィルター処理」でデータを抽出できる。

![](2021-06-15-11-35-00.png)

## 日付

### 現在日時の取得
「現在の時刻」を使う。

![](2021-06-15-11-05-52.png)

タイムゾーンがUTCになっているので、日本時間へ変換してから扱った方がいい場合がある。

### タイムゾーンと書式の変換
「タイムゾーンの変換」を使うと、ついでに書式の変換もできる。

![](2021-06-15-11-09-24.png)

## トラブルシューティング

### メールの添付ファイルを保存できない

現象：  
メール受信をトリガーとしたフローで、添付ファイルの保存がエラーとなるか、保存できても0KBになってしまう。

原因：  
メール受信トリガーで、「添付ファイルを含める」を「はい」にしていない。
