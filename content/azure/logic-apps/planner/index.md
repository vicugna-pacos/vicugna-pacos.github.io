---
title: "Planner"
date: 2022-03-17T16:18:55+09:00
draft: true
---

[MS のドキュメント](https://docs.microsoft.com/en-us/connectors/planner/)

## チェックリスト付きのタスクを作成する
「タスクを作成する (CreateTask_V3)」アクションを使う。ただ、このアクションで指定できるのは下記の項目だけで、チェックリストやコメントは付けられない。

* タイトル
* バケットID (どのバケットに作るか)
* 開始日時
* 期限日時
* 担当者
* ラベル

チェックリストを付けたい場合は、タスクを作成した後に「タスクの詳細の更新 (UpdateTaskDetails_V2)」アクションを使う。
チェックリストの数が動的に変化する場合は、アレイ型の変数に、id、title、isChecked の3つをキーに持つオブジェクトを追加していくと良い。

下記は、サンプルのフローの全体。

![](2022-03-17-16-29-03.png)

ここからは、上記フローの詳細を1つずつ解説する。

まず初めに、アレイ型の変数を初期化する。

![](2022-03-17-16-29-27.png)

次に「変数」コネクタにある「配列変数に追加」を使う。値には id、title、isChecked の3つのキーを持つオブジェクトをJSON形式で指定する。

![](2022-03-17-16-30-13.png)

これを追加したい項目の数だけ繰り返す。

そして最後にタスクを作成し、その作成した直後のタスクに対して「タスクの詳細を更新」する。

![](2022-03-17-16-32-41.png)

更新対象の「タスクID」はリストから選択するのではなく、「カスタム項目の追加」をクリック → 動的な値を追加 → 「タスクを作成する」の「ID」を指定する。

![](2022-03-17-16-35-11.png)

そしてチェックリストは、「アレイ全体の入力へ切り替える」をクリックしてから、先ほど作ったアレイ変数を指定する。

![](2022-03-17-16-40-55.png)

フローの説明は以上。このフローを実行すると、新しいタスクが作成され、チェックリストも付いている。

![](2022-03-17-16-46-41.png)

## タスクをチェックリスト付きでコピーする

