<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-143399608-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-143399608-2');</script><meta name=generator content="Hugo 0.74.1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel=stylesheet href=https://vicugna-pacos.github.io/css/normalize.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/main.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/pagination.css><title>Visual Studio Code で開発する - アルパカのメモ</title></head><body><header class=header-area><div class=content-container><span class=logo-text><a href=/>アルパカのメモ</a></span></div></header><div class=content-container><nav><ol class=breadcrumbnav><li>Home</li><li>PowerShell</li></ol></nav></div><main class=main-area><div class="content-container single"><div class=side><aside class=toc><p>目次</p><nav id=TableOfContents><ul><li><a href=#拡張機能の追加>拡張機能の追加</a></li><li><a href=#文字コードの設定を変更>文字コードの設定を変更</a></li><li><a href=#デバッグの設定>デバッグの設定</a><ul><li><a href=#開いているスクリプトを起動するようにする>開いているスクリプトを起動するようにする</a></li><li><a href=#デバッグ時は一時的なセッションを使う>デバッグ時は一時的なセッションを使う</a></li></ul></li></ul></nav></aside></div><div class=main><article><h1>Visual Studio Code で開発する</h1><div class=article-info><div><i class=material-icons>calendar_today</i>
<time datetime="2021-04-23 16:03:28 +0900 +0900" itemprop=datePublished>2021-04-23</time></div><div></div></div><h2 id=拡張機能の追加>拡張機能の追加</h2><ol><li>VSCodeでps1ファイルを開く。</li><li>PowerShellの拡張機能をインストールするか聞かれるので、インストールする。</li></ol><h2 id=文字コードの設定を変更>文字コードの設定を変更</h2><p>PowerShell ISE の既定の文字コードは UTF-8 bom付 だが、VSCodeは UTF-8。この違いが原因で日本語を出力した際などに文字化けするため、設定を変更する。</p><p><code>F1</code> または <code>Ctrl</code> + <code>Shift</code> + <code>P</code> を押してコマンドパレットを表示する。</p><p><code>Configure Language Specific Settings</code> と入力、出てきたものをクリック。<br><img src=2021-04-23-16-05-58.png alt></p><p><code>PowerShell</code> を選ぶ。<br><img src=2021-04-23-16-06-20.png alt></p><p>Settings.jsonが開くので、<code>"files.encoding": "utf8bom"</code> を追記する。</p><p>Settings.jsonを保存して閉じる。</p><h2 id=デバッグの設定>デバッグの設定</h2><h3 id=開いているスクリプトを起動するようにする>開いているスクリプトを起動するようにする</h3><p>エディタウィンドウで開いているファイルをデバッグするように設定する手順。</p><p>「実行」のタブを開く(<code>Ctrl</code> + <code>Shift</code> + <code>D</code>)。</p><p>「launch.jsonファイルを作成します」のリンクを押す。</p><p>「Launch Current File」を選ぶ。</p><p><img src=2021-04-23-16-07-44.png alt></p><p>launch.jsonが作成されて表示されるので、閉じる。</p><p>これで、デバッグしたいps1ファイルを開いた状態でF5を押すと、そのファイルが実行されるようになる。</p><h3 id=デバッグ時は一時的なセッションを使う>デバッグ時は一時的なセッションを使う</h3><p>VSCode でスクリプトをデバッグするときは、ターミナルに表示されている「PowerShell Integrated Console」で実行される。
このままだとずっと同じセッションが再利用されるので、例えば psm1 ファイルを編集してデバッグしても、変更後の内容が反映されなかったりする。
これを防ぐために、拡張機能の設定を変更し、デバッグ実行の度に一時的なセッションを開くようにする。</p><p>手順は下記の通り：</p><ol><li><p>Ctrl + , で設定を開く。</p></li><li><p>検索欄に「session」と入力し、カテゴリ 拡張機能 → PowerShell Configuration の中にある「PowerShell > Debugging: Create Temporary Integrated Console」のチェックボックスをオンにする。</p></li></ol><p><img src=2021-04-23-16-11-54.png alt></p></article></div></div></main><footer class=footer-area><div class=content-container><hr><div class=author-container><div class=avatar><img src=/images/avatar.jpg></div><div class=author><p class=author-name>alpaca</p><p>おおむねSIerにいますが、他業種の社内SEだったこともあります。</p><p><a href=https://github.com/vicugna-pacos><img src=/images/GitHub-Mark-32px.png style=width:2rem></a></p></div></div></div></footer></body></html>