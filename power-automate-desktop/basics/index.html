<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-0L8LJXJEKX"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-0L8LJXJEKX');</script><meta property="og:title" content="基本的なこと色々"><meta property="og:description" content="インストール https://flow.microsoft.com/ja-jp/desktop/ 上記URLへアクセスし、アプリをダウンロードしてインストールする。 Windows 10 ユーザーであれば無料で利用できるが、以下の条件がある。 他のオンラインで使う Microsoft 製品 (例えば Power Automate のクラウドフローとか？)"><meta property="og:type" content="article"><meta property="og:url" content="https://vicugna-pacos.github.io/power-automate-desktop/basics/"><meta property="article:published_time" content="2021-07-08T11:23:47+09:00"><meta property="article:modified_time" content="2021-12-29T12:29:40+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="基本的なこと色々"><meta name=twitter:description content="インストール https://flow.microsoft.com/ja-jp/desktop/ 上記URLへアクセスし、アプリをダウンロードしてインストールする。 Windows 10 ユーザーであれば無料で利用できるが、以下の条件がある。 他のオンラインで使う Microsoft 製品 (例えば Power Automate のクラウドフローとか？)"><meta name=generator content="Hugo 0.74.1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel=stylesheet href=https://vicugna-pacos.github.io/css/normalize.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/main.css><link rel=stylesheet href=https://vicugna-pacos.github.io/css/pagination.css><title>基本的なこと色々 - アルパカのメモ</title></head><body><header class=header-area><div class=content-container><span class=logo-text><a href=/>アルパカのメモ</a></span></div></header><div class=content-container><nav><ol class=breadcrumbnav><li>Home</li><li>Power Automate Desktop</li></ol></nav></div><main class=main-area><div class="content-container single"><div class=side><aside class=toc><p>目次</p><nav id=TableOfContents><ul><li><a href=#インストール>インストール</a></li><li><a href=#画面構成>画面構成</a></li><li><a href=#excel-の操作>Excel の操作</a><ul><li><a href=#セル範囲の読取>セル/範囲の読取</a></li></ul></li><li><a href=#変数の型>変数の型</a><ul><li><a href=#リスト>リスト</a></li><li><a href=#データテーブル>データテーブル</a></li><li><a href=#カスタムオブジェクト>カスタムオブジェクト</a></li><li><a href=#その他の型>その他の型</a></li></ul></li></ul></nav></aside></div><div class=main><article><h1>基本的なこと色々</h1><div class=article-info><div><i class=material-icons>calendar_today</i>
<time datetime="2021-07-08 11:23:47 +0900 +0900" itemprop=datePublished>2021-07-08</time>
(最終更新：<time datetime="2021-12-29 12:29:40 +0900 +0900" itemprop=dateModified>2021-12-29</time>)</div><div></div></div><h2 id=インストール>インストール</h2><p><a href=https://flow.microsoft.com/ja-jp/desktop/>https://flow.microsoft.com/ja-jp/desktop/</a></p><p>上記URLへアクセスし、アプリをダウンロードしてインストールする。
Windows 10 ユーザーであれば無料で利用できるが、以下の条件がある。</p><ul><li>他のオンラインで使う Microsoft 製品 (例えば Power Automate のクラウドフローとか？) を使ったことがない場合は、サインアップ (利用登録) が必要。</li><li>Power Automate Desktop で作るフロー (デスクトップフロー) は個人アカウントに保存され、他人と共有はできない。<ul><li>他人とフローを共有し、組織内で働く RPA として開発したい場合は有料プランが必要。</li></ul></li></ul><h2 id=画面構成>画面構成</h2><p><img src=2021-07-08-16-00-27.png alt></p><p>フロー内で使う変数は、アクションの出力結果などとして自動的に定義されることが多い。
自分で変数を定義したい場合は、「変数の設定」アクションを使用する。</p><h2 id=excel-の操作>Excel の操作</h2><p>基本の流れは下記の通り。</p><ol><li>Excel を起動</li><li>読み書きしたいシートをアクティブにする</li><li>セルの値を読み書きする</li><li>Excel を終了</li></ol><p>特徴として、操作対象になるシートを逐次アクティブ化する必要がある。</p><p>下記は、新しい Excel ファイルを作成し A1 セルに「test」と書き込むサンプル。</p><p><img src=2021-07-08-15-07-47.png alt></p><p>Excel を終了する際にファイルパスを指定して保存している。</p><h3 id=セル範囲の読取>セル/範囲の読取</h3><p>「Excel ワークシートから読み取り」アクションを使用する。このアクションで、単一のセル・範囲指定 の両方の読み取りができる。
他のアクションにも見られる特徴だが、単一セルを読むか範囲を読むかによって、出力される変数の型が変わる。</p><h2 id=変数の型>変数の型</h2><p>参考：<a href=https://docs.microsoft.com/en-us/power-automate/desktop-flows/variable-data-types target=_blank rel=noopener>Variable data types - Power Automate | Microsoft Docs</a></p><h3 id=リスト>リスト</h3><p>一次元配列。</p><p>配列の各要素 (PADでは項目と表記) には色々な型を設定できる。カスタムオブジェクトも入れられる。
また、要素の型がバラバラでもよい。1番目に文字列を入れ、2番目にカスタムオブジェクトを入れる…ということもできる (やらない方がよいが)。</p><p>リストの項目の操作は、それぞれ専用のアクションを使う。</p><p><img src=2021-12-29-11-49-21.png alt></p><p>空のリストに対して、 <code>%List[2]%</code> に直接代入…ということはできない。</p><h3 id=データテーブル>データテーブル</h3><p>列と行からなる形式。列には名前が付けられる。</p><p>データテーブルの書き方：</p><ul><li><code>%{}%</code> ： 空のデータテーブル</li><li><code>%{ ^['header1', 'header2'] }%</code> ： 列名だけ定義している</li><li><code>%{ ^['header1', 'header2'], ['value1', 'value2'] }%</code> ： 列名とデータを1行定義している</li><li><code>%NewVar + ['value3', 'value4']%</code> ： 既存のデータテーブルに行追加</li><li><code>%NewVar[1]['header1']%</code> ： 特定の位置にある値を参照。値の設定先にも指定できる。</li></ul><p>上記のように新しいデータテーブルを定義したり行を追加したりはできるが、定義済みのデータテーブルに対して、列の追加、列の削除、行の削除はできない。
その場合は、別のデータテーブルを作ってデータを移すか、<a href=https://docs.microsoft.com/en-us/power-automate/desktop-flows/how-to/delete-row-column-datatable target=_blank rel=noopener>Excelに一時的に書き込んでExcel上で編集する</a>といい。</p><h3 id=カスタムオブジェクト>カスタムオブジェクト</h3><p>JSONの記法で任意のキーと値を持ったオブジェクトを作れる。</p><p>カスタムオブジェクトの書き方：</p><ul><li><code>%{{ }}%</code> ： 空のオブジェクト</li><li><code>%{NewVal['key1']:'value1'}%</code> ： 決まったキーと値がある場合</li><li><code>%{NewVal[key1]:value1}%</code> ： シングルクォーテーションがない場合は変数とみなされる</li></ul><p>「変数の設定」アクションで、「設定」を <code>%{NewVal['key1']}%</code> という風にすると、新しいキーと値を追加できる。</p><p><img src=2021-12-29-11-31-35.png alt></p><p>また、<code>%{ 'key1': ['value1', 'value2'] }%</code> のように配列を含めることもできるが、配列に対して項目を増減できない。</p><p><img src=2021-12-29-11-40-25.png alt></p><p>連続データを扱いたい場合は、素直にデータテーブルかリストを使う方がよさそう。</p><h3 id=その他の型>その他の型</h3><p>ブラウザインスタンスとか、特定のアクションで取得できる変数の型がある。それらも含めた型とプロパティは、下記ドキュメントを参照。</p><p>参考：<a href=https://docs.microsoft.com/en-us/power-automate/desktop-flows/datatype-properties target=_blank rel=noopener>Datatype properties - Power Automate | Microsoft Docs</a></p></article></div></div></main><footer class=footer-area><div class=content-container><hr><div class=author-container><div class=avatar><img src=/images/avatar.jpg></div><div class=author><p class=author-name>alpaca</p><p>おおむねSIerにいますが、他業種の社内SEだったこともあります。</p><p><a href=https://github.com/vicugna-pacos><img src=/images/GitHub-Mark-32px.png style=width:2rem></a></p></div></div></div></footer></body></html>